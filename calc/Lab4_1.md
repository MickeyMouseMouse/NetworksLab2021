# Lab4_1: Online Calculator  

Server: https://github.com/MickeyMouseMouse/NetworksLab2021/blob/lab4_1/calc/server.py  
Client: https://github.com/TsaplinIA/NetworksLab2021/blob/Lab4_1/client.py  

В данной лабораторной работе создано веб-приложение "Калькулятор" на языке Python с использованием веб-фреймворка Flask.  
Реализовано:  
* авторизация пользователей по логину и паролю  
* выполнение быстрых операций (+, -, \*, \/)  
* выполнение медленных операций (sqrt, !) с отложенным ответом сервера  

Для коммуникации клиента и сервера используется SocketIO. Клиент с помощью метода emit посылает запросы на сервер и получает ответы через callback вызовы. Также сервер посылает сообщения клиенту с помощью emit.  

Описание работы Python библиотеки socketio_client: https://pypi.org/project/socketIO-client/  

Описание протокола взаимодействия:  
1. Клиент с помощью метода emit() вызывает на сервере событие "user_login" и передает ему параметры "login" и "password" с соответсвующими данными, затем ожидает вызов callback функции с параметрами в виде словаря и кода состояния HTTP. Если авторизация прошла успешно, то в словаре поле "status" содержит строку "success", а поле "login" - логин авторизованного пользователя. Если авторизация не прошла, то возвращается словарь только с полем "status", содержащим строку "failed".  
2. Авторизованный клиент с помощью метода emit() вызывает на сервере событие "fast_calc" и передает ему параметры "operation" ("+" или "-" или "\*" или "/"), "operand1" (тип str) и "operand2" (тип str), затем ожидает вызов callback функции с параметрами в виде словаря и кода состояния HTTP. Словарь содержит ответ сервера на поставленную задачу.  
3. Авторизованный клиент с помощью метода emit() вызывает на сервере событие "slow_calc" и передает ему параметры "operation" ("!" или "sqrt") и "value", затем ожидает вызов callback функции с параметрами в виде словаря и кода состояния HTTP. Словарь содержит ответ сервера на поставленную задачу.  
4. Сервер с помощью метода emit() может вызывать у авторизованного клиента событие "server_message", передавая ему словарь с соответсвующим информационным сообщением и код состояния HTTP.  
5. Для правильного завершения работы клиент должен с помощью метода emit() вызывает на сервере событие "user_logout", а также закрыть socketio соединение.  
