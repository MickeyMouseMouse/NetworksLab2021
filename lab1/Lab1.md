# Lab1: Система обмена позитивным контентом  
**Описание протокола взаимодействия сервера и клиента**  
1) клиент отправляет свой никнейм на сервер (символ '\' запрещен): {"nickname":"Ivan"}  
2) сервер проверяет, не занят ли полученный никнейм другим пользователем или самим сервером ('SERVER')  
и отвечает клиенту согласием или ошибкой: {"status":"success"} / {"status":"error: this nickname is already taken"}  
3.1) после логина клиент отсылает сообщение с полем "text" или полями "text" и "attachment":  
{"text":"Hello"} / {"text":"Hello", "attachment":"1.jpg"}  
3.2) если у текстового сообщения есть вложение ("attachment":"sample.file"),  
то далее отправляется требуемый файл в виде массива байт (b'...')  
4.1) сервер пересылает каждое полученное текстовое сообщение всем клиентам, кроме отправителя:  
{"time":"2021-09-27 12:34:56.789000+00:00", "nickname": "Ivan", "text":"Hello"} /  
{"time":"2021-09-27 12:34:56.789000+00:00", "nickname": "Ivan", "text":"Hello", "attachment":"1.jpg"}  
4.2) если у текстового сообщения есть вложение, то сервер пересылает и его в виде массива байт  

**Сериализация данных**  
Модуль "Serialization.py" (самодельный аналог JSON) содержит следующие функции:
1) "dump" для конвертации словаря в массив байт  
2) "load" для конвертации массива байт в словарь  

**Серверный скрипт**  
1) обрабатывает каждого клиента в отдельном потоке  
2) присваивается полученным сообщением время в формате UTC  
3) помимо рассылки полученных сообщений, также уведомляет клиентов о подключении/отключении пользователей  
4) не хранит историю переписки  

**Клиентский скрипт**  
1) запускается с одним аргументом, соответствующим желаемому никнейму  
2) способен одновременно отправлять и принимать сообщения  
3) предлагает к каждому текстовому сообщению также добавить вложение в виде файла (полученные от собеседников файлы сохраняются в текущей директории)  
4) при потере связи с сервером сразу же сообщает об этом  
5) для отключения от сервера и завершения нужно ввести "\q"  

**Тестирование клиент-серверного приложения на удаленном сервере**  
![](https://raw.githubusercontent.com/MickeyMouseMouse/NetworksLab2021/lab1/lab1/images/check.PNG "")